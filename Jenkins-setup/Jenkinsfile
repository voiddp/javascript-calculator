pipeline {
  agent any
  stages {
    stage('Cloning Git') {
      steps {
        git 'https://github.com/voiddp/javascript-calculator.git'
      }
    }
    stage('Processing Files') {
      steps {
          sh 'chmod +x ./Jenkins-setup/build.sh'
		  sh './Jenkins-setup/build.sh'
      }
    }
	environment {
		registry = "voiddp/nginx-calc"
		registryCredential = 'dockerhub'
	}	
	stage('Bulding Image') {
      steps {
	   sh 'docker build -t "$registry:$BUILD_NUMBER" -f ./Jenkins-setup/Dockerfile .'
      }
    }	
	stage('Push to Hub') {
      steps {
		sh 'docker push $registry:$BUILD_NUMBER'
		sh 'docker rmi $registry:$BUILD_NUMBER'
      }
    }
	
  }
}
